# TODOS

## High Prio
1. Gifs for README [High Prio/Manual?] - GIF placeholders added ✓
2. Rotate All Prod Keys [Manual/Tomorrow]
3. Fix Production API Errors (dev-codex.com ERR_NAME_NOT_RESOLVED)

## Production Deployment Issue - dev-codex.com API Errors

### Problem
Frontend in production is getting `ERR_NAME_NOT_RESOLVED` errors when trying to call `/api` endpoints. Console shows:
- `GET https://dev-codex.com/api/notifications?limit=5 net::ERR_NAME_NOT_RESOLVED`
- `GET https://dev-codex.com/api/news/important net::ERR_NAME_NOT_RESOLVED`
- Multiple Sentry POST errors blocked by client

### Current Setup
- Both `www.dev-codex.com` and `dev-codex.com` domains configured
- Railway serving both frontend and backend on same server
- Backend serves frontend from `/app/frontend/dist` in production
- Frontend uses relative path `baseURL: '/api'` in axios config

### Required Railway Environment Variables
On your Railway project, set these environment variables:

```bash
# CORS Configuration (CRITICAL - required for production)
CORS_ORIGINS=https://dev-codex.com,https://www.dev-codex.com

# Frontend URL (for redirects, emails, etc.)
FRONTEND_URL=https://www.dev-codex.com

# Or if using non-www as primary:
# FRONTEND_URL=https://dev-codex.com
```

### Steps to Fix
1. Go to Railway dashboard → Your project → Variables tab
2. Add/update `CORS_ORIGINS` with both domains: `https://dev-codex.com,https://www.dev-codex.com`
3. Add/update `FRONTEND_URL` with your primary domain
4. Redeploy if needed (Railway should auto-redeploy on env var change)
5. Rebuild frontend with production env file

### Create frontend/.env.production
```bash
# API Configuration - Use relative path since backend serves the frontend
VITE_API_URL=/api

# Sentry Configuration
VITE_SENTRY_DSN=https://ddc10c432f6750ea4d907a0f6a824f1f@o4510008790351872.ingest.us.sentry.io/4510326488039424
VITE_SENTRY_ENVIRONMENT=production
VITE_SENTRY_ORG=dev-codex

# Stripe - Replace with production key when ready
VITE_STRIPE_PUBLISHABLE_KEY=pk_test_51RYe8CPE27kZDTVQ8aai4ZW0Q97T95mff2KUm7DZSG8JbeaUY2vG7cdWfYxeLfrSpWlyvGpfpPBz39AqBWZctn5r00HmH509gv
```

### Root Cause: HARDCODED URL IN linkGoogle() ✅ FIXED
Found the actual issue by inspecting the production bundle.

**Problem:** `frontend/src/api/auth.ts:34` had:
```typescript
linkGoogle(): void {
  window.location.href = `${import.meta.env.VITE_API_URL || 'http://localhost:5003'}/api/auth/google/link`;
}
```

When you built for production at some point, `VITE_API_URL` was set to `https://dev-codex.com`, which got baked into the bundle as a hardcoded absolute URL.

**Fix Applied:** Changed to use relative URL like all other API calls:
```typescript
linkGoogle(): void {
  window.location.href = '/api/auth/google/link';  // ✓ Now relative
}
```

**To Deploy:**
```bash
git add frontend/src/api/auth.ts
git commit -m "fix: use relative URL for Google OAuth link"
git push
```

Railway will auto-deploy and rebuild with the fix.

## Medium Prio
4. Be able to accept more than 10 batched commands, process them in batches of 10 still though, for rate limiting etc?
5. Link social side to /terminal?
6. Add Screenshots to publicpages

## Low Prio
7. contrastcolor is a little weird depending on the base background theme color? specifically on things with project.color/selectedproject.color [Low Prio -skip for now, you cant figure it out]
8. Clean / Refactor Inefficient / Repetetive Code [Plan/High Prio] ✓ COMPLETED
   - Comprehensive plan created: md_files/current/code-refactoring-plan.md